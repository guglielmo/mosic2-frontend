<h3 class="page-title">Fascicolo - <span class="fw-semi-bold">Tutti i fascicoli</span></h3>

<section class="widget" widget data-widgster-collapsed="true">
    <header>
        <h5>
            <a data-widgster="expand" title="Apri"><i class="fa fa-search"></i> Filtra <span class="fw-semi-bold">fascicoli ...</span> </a>
            <a data-widgster="collapse" title="Chiudi"><i class="fa fa-search"></i> Filtra <span class="fw-semi-bold">fascicoli ...</span> </a>
        </h5>

        <div class="widget-controls m-t-1">
            <a data-widgster="expand" title="Apri"><i class="glyphicon glyphicon-chevron-down"></i></a>
            <a data-widgster="collapse" title="Chiudi"><i class="glyphicon glyphicon-chevron-up"></i></a>
        </div>
    </header>
    <div class="widget-body">
        <div class="row">
            <div class="col-lg-4">
                <div class="form-group">
                    <label for="titolari_id"><strong>Titolario</strong></label>
                    <select2 id="titolari_id"
                             class="full-width-select"
                             [options]="select2Options"
                             cssImport="false"
                             (valueChanged)="select2Changed($event)"
                             [data]="apiService.titolariSelect"></select2>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="form-group">
                    <label for="argomento"><strong>Argomento</strong></label>
                    <input id="argomento" name="argomento" class="form-control" [(ngModel)]="filterQuery"/>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="form-group">
                    <label for="amministrazione"><strong>Amministrazione</strong></label>
                    <select2 id="amministrazione"
                             class="full-width-select"
                             [options]="select2Options"
                             cssImport="false"
                             (valueChanged)="select2Changed($event)"
                             [data]="apiService.amministrazioneSelect"></select2>
                </div>
            </div>
        </div>
    </div>
</section>

<div class="row">
    <div class="col-lg-12">
        <section class="widget" widget>
            <div class="widget-body">
                <table class="table table-hover table-condensed mb-0" [mfData]="apiService.fascicoli | dataFilter : filterQuery" #mf="mfDataTable"
                       stickthead>
                    <thead>
                    <tr>
                        <th>
                            <mfDefaultSorter by="codice_titolario">Titolario</mfDefaultSorter>
                        </th>
                        <th>
                            <mfDefaultSorter by="numero_fascicolo">Fascicolo</mfDefaultSorter>
                        </th>
                        <th>
                            <mfDefaultSorter by="argomento">Argomento</mfDefaultSorter>
                        </th>
                        <th>
                            <mfDefaultSorter by="amministrazione">Amministrazione</mfDefaultSorter>
                        </th>
                        <th>Azioni</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr *ngFor="let fascicolo of mf.data" (click)="editId(fascicolo.id)" class="clickable">
                        <td>{{apiService.titolariEnum[fascicolo.codice_titolario]}}</td>
                        <td>{{fascicolo.numero_fascicolo}}</td>
                        <td>{{fascicolo.argomento}}</td>
                        <td>{{apiService.amministrazioneEnum[fascicolo.amministrazione]}}</td>
                        <td>
                            <a (click)="askDeleteFascicoli(myModal, fascicolo)"><i class="fa fa-trash-o"> </i></a>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <footer>
            </footer>
        </section>
    </div>
</div>


<modal #myModal cancelButtonLabel="Annulla" submitButtonLabel="Conferma" [hideCloseButton]="true" (onSubmit)="confirmDeleteFascicoli(myModal)">
    <modal-header>
        <h4 class="modal-title text-xs-center fw-bold mt">Conferma cancellazione fascicolo</h4>
    </modal-header>
    <modal-content>
        <h4 class="text-xs-center mt-sm">
            Vuoi eliminare il fascicolo <strong>{{deletingFascicoli.numero_fascicolo}} </strong><br/>
            {{deletingFascicoli.argomento}} -
            {{deletingFascicoli.amministrazione}} ?
        </h4>
    </modal-content>
    <modal-footer>
    </modal-footer>
</modal>